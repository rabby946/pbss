{% extends "admin/base.html" %}
{% block title %}Student Attendances{% endblock %}

{% block content %}
<h2>Student Attendance ({{ selected_date.strftime('%d %b %Y') }})</h2>

<form method="GET" class="mb-3">
  <label>Select Date:</label>
  <input type="date" name="date" value="{{ selected_date }}" max="{{ today }}">
  <button type="submit" class="btn btn-primary btn-sm">View</button>
</form>

<table class="table table-bordered table-striped">
  <thead>
    <tr>
      <th>Student Name</th>
      <th>Student ID</th>

      <th>Class</th>
      <th>Section</th>
      <th>Roll</th>
      <th>Status</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for student in students %}
      {% set att = attendance_dict.get(student.id) %}
      <tr>
        <td>{{ student.name }}</td>
        <td>{{ student.studentID }}</td>
        <td>{{ student.class_.name if student.class_id else '-' }}</td>
        <td>{{student.class_.section}}</td>
        <td> {{student.roll}} </td>
        <td>
          {% if att %}
            {{ att.status }}
          {% else %}
            <span class="text-muted">Not Marked</span>
          {% endif %}
        </td>
        <td>
          <a href="{{ url_for('admin_bp.attendance', student_id=student.id, date=selected_date) }}" 
             class="btn btn-sm btn-info">
            View History
          </a>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>

<hr>
{% endblock %}
